---
authors: ['Wudji']
---

# 9.æˆ˜åˆ©å“è¡¨

***

æ¨èé˜…è¯»ï¼š[Minecraft åŸç‰ˆæ¨¡ç»„å…¥é—¨æ•™ç¨‹ - æˆ˜åˆ©å“è¡¨(ä½œè€…ruhuasiyu)](https://www.mcbbs.net/plugin.php?id=link\_redirect\&target=https%3A%2F%2Fzhangshenxing.gitee.io%2Fvanillamodtutorial%2F%23%E6%88%98%E5%88%A9%E5%93%81%E8%A1%A8)

## ä¸€ã€äº‹ä»¶ç›‘å¬

`ServerEvents`ä¸‹æœ‰å¤šä¸ªç”¨äºä¿®æ”¹æˆ˜åˆ©å“è¡¨çš„å­äº‹ä»¶ï¼š

| äº‹ä»¶                             | æè¿°                       |
| -------------------------------- | -------------------------- |
| `ServerEvents.blockLootTables`   | æ–¹å—æˆ˜åˆ©å“è¡¨ä¿®æ”¹           |
| `ServerEvents.chestLootTables`   | å®ç®±æˆ˜åˆ©å“è¡¨ä¿®æ”¹           |
| `ServerEvents.giftLootTables`    | ç¤¼ç‰©æˆ˜åˆ©å“è¡¨ä¿®æ”¹\[1]       |
| `ServerEvents.entityLootTables`  | å®ä½“æˆ˜åˆ©å“è¡¨ä¿®æ”¹           |
| `ServerEvents.fishingLootTables` | é’“é±¼æˆ˜åˆ©å“è¡¨ä¿®æ”¹           |
| `ServerEvents.genericLootTables` | æˆ˜åˆ©å“è¡¨ä¿®æ”¹ï¼ˆæŒ‰å‘½åç©ºé—´ï¼‰ |

\[1]å¦‚çŒ«ã€æ‘æ°‘(æ‘åº„è‹±é›„)ç­‰ã€‚

ä»¥ä¿®æ”¹æ–¹å—æˆ˜åˆ©å“è¡¨ä¸ºä¾‹ï¼š

```js
ServerEvents.blockLootTables(event =>{
    // code here
})
```

## äºŒã€æˆ˜åˆ©å“è¡¨ä¿®æ”¹

KubeJSæ·»åŠ äº†ä¸€äº›æ–¹æ³•æ¥ç®€åŒ–æˆ˜åˆ©å“è¡¨çš„ä¿®æ”¹ã€‚

è¿™é‡Œä»¥ä¿®æ”¹æ–¹å—æˆ˜åˆ©å“è¡¨ä¸ºä¾‹ï¼š

| äº‹ä»¶æ–¹æ³•                                                   | åŠŸèƒ½                       | è¡¥å……è¯´æ˜              |
| ---------------------------------------------------------- | -------------------------- | --------------------- |
| addSimpleBlock(BlockStatePredicate æ–¹å—)                   | å¿«æ·æ·»åŠ æ‰è½è‡ªèº«çš„æˆ˜åˆ©å“è¡¨ | å¯ä»¥ä¼ å…¥tagã€æ–¹å—IDç­‰ |
| addBlock(BlockStatePredicate æ–¹å—,LootBuilder æˆ˜åˆ©å“è¡¨)    | è®¾ç½®æˆ˜åˆ©å“è¡¨               | è§ä¸‹                  |
| modifyBlock(BlockStatePredicate æ–¹å—,LootBuilder æˆ˜åˆ©å“è¡¨) | ä¿®æ”¹æˆ˜åˆ©å“è¡¨               | è§ä¸‹                  |
| addJson(å‘½åç©ºé—´ æˆ˜åˆ©å“è¡¨ID, JsonObject æˆ˜åˆ©å“è¡¨)          | ç›´æ¥æ·»åŠ jsonæ ¼å¼çš„æˆ˜åˆ©å“è¡¨ | -                     |

å¯¹äºå…¶ä»–ç±»å‹çš„æˆ˜åˆ©å“è¡¨ä¿®æ”¹ï¼Œä½ åªéœ€è¦ä¿®æ”¹æ–¹æ³•åï¼Œå…¶ä»–å†…å®¹å¤§åŒå°å¼‚ã€‚ä¾‹å¦‚å®ä½“å¯¹åº”çš„æˆ˜åˆ©å“è¡¨è®¾ç½®æ–¹æ³•ä¸º`addEntity`ï¼Œè€Œé’“é±¼çš„åˆ™ä¸º`addFishing`ï¼Œä»¥æ­¤ç±»æ¨ã€‚

## ä¸‰ã€LootBuilder

LootBuilderæ·»åŠ äº†ä¸€ç³»åˆ—ç”¨äºä¿®æ”¹æˆ˜åˆ©å“è¡¨çš„æ–¹æ³•ï¼š

| ğŸ”æ–¹æ³•                                                     | åŠŸèƒ½                     | è¡¥å……è¯´æ˜                       |
| --------------------------------------------------------- | ------------------------ | ------------------------------ |
| addCondition(JsonObject æˆ˜åˆ©å“è¡¨æ¡ä»¶)                     | æ·»åŠ æˆ˜åˆ©å“è¡¨æ¡ä»¶         | -                              |
| addFunction(JsonObject æˆ˜åˆ©å“è¡¨å‡½æ•°)                      | æ·»åŠ æˆ˜åˆ©å“è¡¨å‡½æ•°         | -                              |
| addPool(LootBuilderPool æˆ˜åˆ©å“æ± )                         | æ·»åŠ æˆ˜åˆ©å“æ±              | -                              |
| randomChance(æ¦‚ç‡)                                        | è®¾ç½®è§¦å‘æ¦‚ç‡             | -                              |
| randomChanceWithLooting(æ¦‚ç‡, å€ç‡)                       | è®¾ç½®æŠ¢å¤ºé™„é­”æ‰è½æ¦‚ç‡     | -                              |
| survivesExplosion()                                       | è®¾ç½®æˆ˜åˆ©å“è¡¨ä¸å—çˆ†ç‚¸å½±å“ | -                              |
| enchantWithLevels(NumberProvider ç­‰çº§, å¸ƒå°”å€¼ æ˜¯å¦ä¸ºå®è—) | è®¾ç½®é™„é­”                 | NumberProvider\[2]             |
| enchantRandomly(å‘½åç©ºé—´\[] é™„é­”é¡¹)                       | éšæœºé™„é­”                 | éšæœºä»ä¼ å…¥çš„é™„é­”ä¸­é€‰æ‹©è¿›è¡Œé™„é­” |
| killedByPlayer()                                          | è®¾ç½®ç”±ç©å®¶å‡»æ€æ‰æ‰è½     | -                              |
| ...                                                       | ...                      | ...                            |

\[2] NumberProviderå¯ä»¥æ¥å—ï¼š`{min: æœ€å°å€¼, max: æœ€å¤§å€¼}`ã€`å•ä¸ªæ•°å­—`

æ³¨æ„ï¼šä¸Šè¿°é™„é­”æ•ˆæœå¿…å®šç”Ÿæ•ˆï¼Œå¦‚éœ€å¯¹å…¶è¿›è¡Œé™åˆ¶ï¼Œä½ éœ€è¦æ·»åŠ æˆ˜åˆ©å“è¡¨æ¡ä»¶ã€‚

## å››ã€LootBuilderPool

| ğŸ”æ–¹æ³• / å±æ€§                                              | åŠŸèƒ½                     | è¡¥å……è¯´æ˜                               |
| --------------------------------------------------------- | ------------------------ | -------------------------------------- |
| addItem(Itemstack ç‰©å“, æƒé‡, æ•°é‡)                       | æ·»åŠ ç›®æ ‡ç‰©å“             | ä»¥ä¸‹å„é¡¹å‡å¯¹ä¹‹ç”Ÿæ•ˆã€‚æƒé‡, æ•°é‡å¯ç•™ç©ºã€‚ |
| å±æ€§ rolls                                                | è®¾ç½®æŠ½å–æ¬¡æ•°             | -                                      |
| setBinomialRolls(n,p)                                     | è®¾ç½®æŠ½å–æ¬¡æ•°(äºŒé¡¹åˆ†å¸ƒ)   | nä¸ºæ€»è¯•éªŒæ¬¡æ•°ï¼Œpä¸ºå•æ¬¡æ¦‚ç‡             |
| setUniformRolls(æœ€å°å€¼, æœ€å¤§å€¼)                           | è®¾ç½®æŠ½å–æ¬¡æ•°(å‡åŒ€åˆ†å¸ƒ)   | æœ€å°->æœ€å¤§æœºä¼šå‡ç­‰                     |
| addEntry(JsonObject é¡¹ç›®)                                 | æ·»åŠ é¡¹ç›®                 | -                                      |
| enchantWithLevels(NumberProvider ç­‰çº§, å¸ƒå°”å€¼ æ˜¯å¦ä¸ºå®è—) | è®¾ç½®é™„é­”                 | NumberProvider\[2]                     |
| enchantRandomly(å‘½åç©ºé—´\[] é™„é­”é¡¹)                       | éšæœºé™„é­”                 | éšæœºä»ä¼ å…¥çš„é™„é­”ä¸­é€‰æ‹©è¿›è¡Œé™„é­”         |
| randomChanceWithLooting(æ¦‚ç‡, å€ç‡)                       | è®¾ç½®æŠ¢å¤ºé™„é­”æ‰è½æ¦‚ç‡     | -                                      |
| survivesExplosion()                                       | è®¾ç½®æˆ˜åˆ©å“è¡¨ä¸å—çˆ†ç‚¸å½±å“ | -                                      |
| killedByPlayer()                                          | è®¾ç½®ç”±ç©å®¶å‡»æ€æ‰æ‰è½     | -                                      |
| randomChance(æ¦‚ç‡)                                        | è®¾ç½®è§¦å‘æ¦‚ç‡             | -                                      |
| randomChanceWithLooting(æ¦‚ç‡, å€ç‡)                       | è®¾ç½®æŠ¢å¤ºé™„é­”æ‰è½æ¦‚ç‡     | -                                      |

æ³¨æ„ï¼Œ`LootBuilder`å’Œ`LootBuilderPool`ä¸­çš„æ¡ä»¶åœ¨ä¸ç›¸ç¬¦æ—¶ä¸ä¼šç”Ÿæ•ˆï¼Œä¾‹å¦‚æŒ–æ˜æ–¹å—æ—¶æ¸¸æˆä¸ä¼šæ£€æŸ¥æ˜¯å¦æ˜¯ç©å®¶å‡»æ€ã€‚

æ³¨æ„ï¼šä¸Šè¿°é™„é­”æ•ˆæœå¿…å®šç”Ÿæ•ˆï¼Œå¦‚éœ€å¯¹å…¶è¿›è¡Œé™åˆ¶ï¼Œä½ éœ€è¦æ·»åŠ æˆ˜åˆ©å“è¡¨æ¡ä»¶ã€‚

## äº”ã€ç¤ºä¾‹

```js
ServerEvents.blockLootTables(event =>{

    // ç®€å•æ–¹å—æˆ˜åˆ©å“è¡¨ï¼ˆæ‰è½è‡ªèº«ï¼‰ï¼ˆè¦†ç›–åŸæˆ˜åˆ©å“è¡¨ï¼‰
    event.addSimpleBlock("minecraft:spawner");

    // æ‰€æœ‰å¸¦æœ‰æ ‡ç­¾çš„æ ‘å¶è¢«ç ´åæ—¶æ‰è½è‡ªèº«ï¼ˆè¦†ç›–åŸæˆ˜åˆ©å“è¡¨ï¼‰
    event.addSimpleBlock("#minecraft:leaves");

    // ä¿®æ”¹æ³¥åœŸæˆ˜åˆ©å“è¡¨
    // æ•ˆæœï¼šåœ¨ç©å®¶ä½¿ç”¨å¸¦æœ‰æ ‡ç­¾çš„é”¹æŒ–æ˜æ³¥åœŸæ—¶ï¼ŒæŠ½å–æˆ˜åˆ©å“æ± 1å’Œ3ï¼›ä½¿ç”¨é’»çŸ³é”¹æŒ–æ˜æ—¶ï¼ŒæŠ½å–æˆ˜åˆ©å“æ± 1,2å’Œ3ï¼›ä½¿ç”¨å…¶ä»–æŒ–æ˜æ—¶ï¼ŒæŠ½å–æˆ˜åˆ©å“æ± 3ã€‚
    event.addBlock("minecraft:dirt", loot=>{

        // æ·»åŠ æˆ˜åˆ©å“æ± ï¼Œæ³¨æ„ï¼šæ¯ä¸ªæˆ˜åˆ©å“æ± ä¼šåˆ†åˆ«æŠ½å–
        // æ·»åŠ æˆ˜åˆ©å“æ±  1
        loot.addPool(pool=>{

            // æ·»åŠ ç‰©å“ã€å‡½æ•°ã€æ¡ä»¶
            pool.addItem("minecraft:iron_nugget")
            pool.addFunction({
                "function": "minecraft:set_count",
                "count": {
                  "min": 1,
                  "max": 2
                }
              })
            pool.addCondition({
                "condition": "minecraft:match_tool",
                "predicate": {
                  "tag": "forge:tools/shovels"
                }
              })
        })

    // æ·»åŠ æˆ˜åˆ©å“æ±  2
    loot.addPool(pool=>{
        // æ·»åŠ ç‰©å“ï¼ˆå¸¦æƒé‡å’Œæ•°é‡ï¼‰
        pool.addItem("minecraft:flint",2,1);
        pool.addItem("minecraft:iron_ingot",1,1);
        pool.addCondition({
          "condition": "minecraft:match_tool",
          "predicate": {
            "items": [
              "minecraft:diamond_shovel"
            ]
          }
        })
        // è®¾ç½®ç”Ÿæ•ˆæ¦‚ç‡å’ŒæŠ½å–æ¬¡æ•°ã€‚
        pool.randomChance(0.5);
        pool.setBinomialRolls(3,0.3);
    })

    // æ·»åŠ æˆ˜åˆ©å“æ±  3
    loot.addPool(pool=>{
      pool.addItem("minecraft:dirt");
    })

    })
})

ServerEvents.genericLootTables(event =>{

    // ä½ å¯ä»¥é€šè¿‡æŒ‡ä»¤/loot give <ç©å®¶ID> loot wudji:kubejs_tutorial/example_loot_table æ¥è·å–æ­¤æˆ˜åˆ©å“è¡¨ã€‚
    event.addGeneric("wudji:kubejs_tutorial/example_loot_table",loot=>{

        // æ·»åŠ æˆ˜åˆ©å“æ± 
        loot.addPool(pool=>{
            
            // è®¾ç½®æŠ½å–æ¬¡æ•°
            pool.rolls = 1;

            // æ·»åŠ ç‰©å“
            pool.addItem("minecraft:iron_axe",1,1)
            pool.addItem("minecraft:iron_pickaxe",1,1)
            pool.addItem("minecraft:iron_sword",1,1)

            // éšæœºé™„é­”
            pool.enchantRandomly(["minecraft:sharpness","minecraft:unbreaking","minecraft:fortune"]);
        })
        loot.addPool(pool=>{
            pool.rolls = 3;

            // æ·»åŠ ç‰©å“ï¼ˆéšæœºæ•°é‡ï¼‰
            pool.addItem("minecraft:experience_bottle",2,{min:1,max:3});
            pool.addItem("minecraft:golden_apple",1,1);
            
            // è®¾ç½®æ¦‚ç‡
            pool.randomChance(0.5)
        })
    })
})
```